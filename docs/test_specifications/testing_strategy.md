# テスト戦略

## 概要

TaskFlowアプリケーションの品質を保証するために、包括的なテスト戦略を採用しています。この戦略には、ユニットテスト、統合テスト、およびエンドツーエンド (E2E) テストが含まれます。

## テストレベル

### 1. ユニットテスト

-   **目的**: 個々のコンポーネント、関数、モジュールの独立した動作を検証する。
-   **対象**:
    -   UIコンポーネント (例: `TaskCard`, `TaskForm`, `TaskList`)
    -   ユーティリティ関数 (例: `cosmosHelpers`, `errorHandling`)
    -   カスタムフック (例: `useTasks`)
-   **ツール**: Jest, React Testing Library
-   **実行方法**: `npm run test`
-   **詳細**: `test_specifications/unit_testing.md` を参照

### 2. 統合テスト

-   **目的**: 複数のコンポーネントやモジュール間の連携が正しく動作することを確認する。
-   **対象**:
    -   コンポーネント間のインタラクション (例: `TaskList` と `TaskCard` の連携)
    -   APIとの連携 (例: `useTasks` フックとAPIルートの連携)
    -   状態管理 (例: React Queryによるデータの取得と更新)
-   **ツール**: Jest, React Testing Library
-   **実行方法**: `npm run test`
-   **詳細**: `test_specifications/integration_testing.md` を参照

### 3. E2Eテスト

-   **目的**: アプリケーション全体をユーザーの視点からテストし、実際のユーザーシナリオに基づいて機能が正しく動作することを確認する。
-   **対象**:
    -   ユーザーフロー (例: タスクの作成、編集、削除)
    -   クリティカルパス (例: アプリケーションの起動、タスクの表示)
    -   エラーケース (例: 無効な入力、ネットワークエラー)
-   **ツール**: Playwright
-   **実行方法**: `npm run test:e2e`
-   **詳細**: `test_specifications/e2e_testing.md` を参照

## テスト環境

-   **ユニットテスト/統合テスト**:
    -   Node.js環境で実行されます。
    -   Jestは、テストランナー、アサーションライブラリ、モッキングフレームワークとして機能します。
    -   React Testing Libraryは、Reactコンポーネントをレンダリングし、ユーザーインタラクションをシミュレートするためのユーティリティを提供します。
-   **E2Eテスト**:
    -   Playwrightを使用して、実際のブラウザ環境 (Chromium, Firefox, WebKit) でテストを実行します。
    -   テストは、開発サーバー (`npm run dev`) または本番ビルド (`npm run build && npm run start`) に対して実行できます。

## テストデータ

-   **ユニットテスト/統合テスト**:
    -   テストデータは、各テストケース内でモックデータとして定義されます。
    -   `cosmosHelpers` の関数はモック化され、テスト中に実際のCosmos DBへのアクセスが発生しないようにします。
-   **E2Eテスト**:
    -   テスト実行前に、テスト用のCosmos DBデータベースに初期データを投入することができます。
    -   テスト実行後は、データベースを元の状態に戻すか、テストデータを削除します。

## テスト実行

### 開発時

-   **ユニットテスト/統合テスト (監視モード)**: `npm run test`
-   **特定のテストファイル実行**: `npx jest <ファイルパス>`
-   **E2Eテスト**: `npm run test:e2e`

### CI環境

-   **全テスト実行**: `npm run test && npm run test:e2e`
-   **カバレッジレポート生成**: `npx jest --coverage`

## 品質の指標

### カバレッジ要件

-   ステートメントカバレッジ: 80%以上
-   分岐カバレッジ: 75%以上
-   関数カバレッジ: 90%以上
-   行カバレッジ: 80%以上

### パフォーマンス要件

-   E2Eテスト実行時間: 5分以内
-   ユニットテスト実行時間: 1分以内

### テスト結果の報告

-   テスト結果は、コンソールに出力されます。
-   CI環境では、テスト結果とカバレッジレポートが生成され、プルリクエストにコメントとして投稿されます。

## テストのメンテナンス

-   新しい機能やコンポーネントが追加された場合は、対応するテストを追加します。
-   バグが修正された場合は、再発防止のためにテストを追加します。
-   リファクタリングを行う際は、既存のテストがパスすることを確認します。
-   定期的にテストコードをレビューし、必要に応じてリファクタリングを行います。
